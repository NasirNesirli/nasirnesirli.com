{{- /* Schema JSON-LD */ -}}
{{- if not (.Param "disable_jsonld") -}}
{{- if .IsPage -}}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "{{ site.Title }}",
      "item": "{{ site.BaseURL | absLangURL }}"
    }
    {{- if ne .Type "page" -}}
    , {
      "@type": "ListItem", 
      "position": 2,
      "name": "{{ .Section | title }}",
      "item": "{{ printf "/%s/" .Section | absLangURL }}"
    }, {
      "@type": "ListItem",
      "position": 3, 
      "name": "{{ .Title }}",
      "item": "{{ .Permalink }}"
    }
    {{- else -}}
    , {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ .Title }}",
      "item": "{{ .Permalink }}"
    }
    {{- end -}}
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  {{- if eq .Type "page" -}}
  "@type": "WebPage",
  {{- else -}}
  "@type": "BlogPosting",
  {{- end }}
  "headline": "{{ .Title }}",
  "name": "{{ .Title | jsonify }}",
  {{- with .Summary }}
  "description": {{ . | plainify | chomp | jsonify }},
  {{- end }}
  {{- if .IsPage }}
  {{- $keywords := (.Param "tags") | default (.Param "keywords") }}
  {{- if $keywords }}
  "keywords": [
    {{- range $i, $kw := $keywords }}{{if $i}}, {{end}}{{ $kw | jsonify }}{{- end }}
  ],
  {{- end }}
  {{- end }}
  {{- if .IsPage }}
  "articleBody": {{ .Plain | jsonify }},
  {{- end }}
  "wordCount" : "{{ .WordCount }}",
  "inLanguage": "{{ site.Language.Lang }}",
  {{- $image := .Resources.GetMatch "featured*" | default (.Resources.GetMatch "cover*") | default (.Resources.GetMatch "*thumbnail*") | default (.Resources.GetMatch "*cover*") -}}
  {{- $image_link := (.Param "images") | default site.Params.images -}}
  {{- if $image -}}
  "image": "{{ $image.Permalink }}",
  {{- else if $image_link -}}
  "image": {{ (index $image_link 0) | absURL | jsonify }},
  {{- end }}
  {{- if not .PublishDate.IsZero }}
  "datePublished": "{{ .PublishDate.Format "2006-01-02T15:04:05Z" }}",
  {{- end }}
  {{- if not .Lastmod.IsZero }}
  "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z" }}",
  {{- end }}
  "author": {
    "@type": "Person", 
    "name": "{{ (.Param "author") | default site.Author.name | default site.Title }}"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ .Permalink }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ (.Param "author") | default site.Author.name | default site.Title }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ site.BaseURL }}favicon.ico"
    }
  }
}
</script>
{{- end -}}
{{- end -}}